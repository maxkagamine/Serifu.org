@model QuoteViewModel
@inject IOptions<SerifuOptions> Options
@{
    string linksId = $"source-links-{Model.Id}";
}

<li class="quote">
    <partial name="Translation" model="Model.Left" />
    <partial name="Translation" model="Model.Right" />
    <div class="source">
        <div class="source-icon" style="--sprite-index: @((int)Model.Source)"></div>
        <button
            popovertarget="@linksId"
            class="source-title"
            style="anchor-name: --@linksId"
        >
            @Strings.GetResourceString($"SourceTitle_{Model.Source}")
        </button>
        @if (Model.HasContext)
        {
            <span>@Strings.SourceTitleContextSeparator@Model.Context</span>
        }
    </div>
    <div
        popover
        id="@linksId"
        class="source-links popover"
        style="position-anchor: --@linksId"
    >
        @foreach (ExternalLink link in Options.Value.SourceLinks[Model.Source])
        {
            if (link.Language is not null && link.Language != CultureInfo.CurrentCulture.TwoLetterISOLanguageName)
            {
                continue;
            }

            <a href="@link.Url" target="_blank" rel="external noreferrer nofollow">@link.Label</a>
        }
    </div>
</li>
